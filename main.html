<!-- Nofee AI â€“ ê°œì„ ëœ ë‹¨ì¼ í˜ì´ì§€ ì„ë² ë“œ -->
<div id='nofee-ai-wrapper' class='ai-theme'>
  <!-- CSS ë¡œë“œ -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Jacob-PO/nofee_chat@main/main.css">
  
  <!-- ëŒ€ì²´ CSS (CDN ì‹¤íŒ¨ ì‹œ) -->
  <style>
    /* ìµœì†Œí•œì˜ í´ë°± ìŠ¤íƒ€ì¼ */
    #nofee-ai-wrapper {
      width: 100%;
      max-width: 420px;
      margin: 0 auto;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    .nofee-chat-container {
      min-height: 100vh;
      background: #f9faff;
      position: relative;
    }
    .nofee-loading {
      text-align: center;
      padding: 60px 20px;
      color: #666;
    }
  </style>

  <!-- ==========  êµ¬ì¡°  ========== -->
  <div class='nofee-chat-container'>
    <!-- í—¤ë” -->
    <div class='nofee-header'>
      <div class='nofee-header-left'>
        <button class='nofee-back-btn' onclick='window.history.back()' aria-label='ë’¤ë¡œ'>
          <svg width='24' height='24' viewBox='0 0 24 24' fill='none'>
            <path d='M15 18L9 12L15 6' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/>
          </svg>
        </button>
        <div class='nofee-profile-img'>ğŸ¤–</div>
        <div class='nofee-header-text'>
          <h3>ë…¸í”¼ AI ë§¤ë‹ˆì €</h3>
          <p>ìµœì ì˜ íœ´ëŒ€í°ì„ ì°¾ì•„ë“œë ¤ìš”</p>
        </div>
      </div>
      <div class='nofee-header-actions'>
        <button class='nofee-menu-btn' aria-label='ë©”ë‰´'>
          <svg width='24' height='24' viewBox='0 0 24 24' fill='none'>
            <circle cx='12' cy='5' r='2' fill='currentColor'/>
            <circle cx='12' cy='12' r='2' fill='currentColor'/>
            <circle cx='12' cy='19' r='2' fill='currentColor'/>
          </svg>
        </button>
        <button class='nofee-close-btn' onclick='location.reload()' aria-label='ë‹«ê¸°'>
          <svg width='24' height='24' viewBox='0 0 24 24' fill='none'>
            <path d='M18 6L6 18M6 6L18 18' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/>
          </svg>
        </button>
      </div>
    </div>

    <!-- ë©”ì‹œì§€ ì˜ì—­ -->
    <div class='nofee-chat-messages' id='nofeeChat'>
      <div class='nofee-loading' id='nofeeLoading'>
        ë…¸í”¼ AIë¥¼ ì¤€ë¹„í•˜ê³  ìˆìŠµë‹ˆë‹¤...<br>
        <small>ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš” ğŸ’™</small>
      </div>
      
      <div class='nofee-intro-section' id='nofeeIntro' style='display:none'>
        <div class='nofee-intro-avatar'>ğŸ’™</div>
        <h2>ë…¸í”¼ AI ë§¤ë‹ˆì €ì— ë¬¸ì˜í•˜ê¸°</h2>
        <div class='nofee-time-badge' onclick='toggleOperatingHours()'>ìš´ì˜ì‹œê°„ ë³´ê¸° â€º</div>
      </div>
      
      <div class='nofee-operating-hours' id='operatingHours' style='display:none'>
        <p>í‰ì¼: ì˜¤ì „ 10:00 - ì˜¤í›„ 7:00</p>
        <p>ì£¼ë§: ì˜¤ì „ 11:00 - ì˜¤í›„ 6:00</p>
        <p>ê³µíœ´ì¼: íœ´ë¬´</p>
      </div>
    </div>

    <!-- AI ìƒê°ì¤‘ -->
    <div class='nofee-ai-thinking' id='aiThinking' style='display:none'>
      <div class='nofee-ai-dots'>
        <div class='nofee-ai-dot'></div>
        <div class='nofee-ai-dot'></div>
        <div class='nofee-ai-dot'></div>
      </div>
      <div class='nofee-ai-thinking-text'>AIê°€ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤...</div>
    </div>

    <!-- í•˜ë‹¨ ì•¡ì…˜ ë°” -->
    <div class='nofee-input-area'>
      <button class='nofee-action-btn nofee-home-btn' id='homeBtn' aria-label='í™ˆ'>
        <svg width='20' height='20' viewBox='0 0 24 24' fill='none'>
          <path d='M3 9L12 2L21 9V20C21 20.53 20.79 21.04 20.41 21.41C20.04 21.79 19.53 22 19 22H5C4.47 22 3.96 21.79 3.59 21.41C3.21 21.04 3 20.53 3 20V9Z' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/>
          <path d='M9 22V12H15V22' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/>
        </svg>
      </button>
      <button class='nofee-action-btn' id='phoneBtn' aria-label='ìƒí’ˆë³´ê¸°'>
        <svg width='20' height='20' viewBox='0 0 24 24' fill='none'>
          <rect x='5' y='2' width='14' height='20' rx='2' stroke='currentColor' stroke-width='2'/>
          <circle cx='12' cy='18' r='1' fill='currentColor'/>
        </svg>
      </button>
      <button class='nofee-action-btn' id='deliveryBtn' aria-label='ë°°ì†¡ì •ë³´' style='background:#6d8bff'>
        <svg width='20' height='20' viewBox='0 0 24 24' fill='none'>
          <path d='M10 12V17H4V12H10ZM10 12H16M16 12V7H20V12H16ZM16 12V17' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/>
          <circle cx='7' cy='19' r='2' stroke='white' stroke-width='2'/>
          <circle cx='17' cy='19' r='2' stroke='white' stroke-width='2'/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Webflow í¼ (ê°œì¸ì •ë³´ ë™ì˜ í›„ì—ë§Œ ì œì¶œ ê°€ëŠ¥) -->
  <form id='nofee-purchase-form' name='purchase' data-name='Purchase Form' style='display:none'>
    <input type='hidden' name='customer_name' id='customer_name'>
    <input type='hidden' name='customer_phone' id='customer_phone'>
    <input type='hidden' name='customer_region' id='customer_region'>
    <input type='hidden' name='customer_district' id='customer_district'>
    <input type='hidden' name='privacy_consent' id='privacy_consent' value=''>
    <input type='hidden' name='phone_model' id='phone_model'>
    <input type='hidden' name='phone_carrier' id='phone_carrier'>
    <input type='hidden' name='phone_plan' id='phone_plan'>
    <input type='hidden' name='phone_price' id='phone_price'>
    <input type='hidden' name='monthly_payment' id='monthly_payment'>
    <input type='hidden' name='contract_type' id='contract_type'>
    <input type='hidden' name='activation_type' id='activation_type'>
    <input type='hidden' name='timestamp' id='timestamp'>
    <input type='hidden' name='session_id' id='session_id'>
    <input type='hidden' name='utm_source' id='utm_source'>
    <input type='hidden' name='utm_medium' id='utm_medium'>
    <input type='hidden' name='utm_campaign' id='utm_campaign'>
    <input type='submit' value='Submit' id='nofee-submit-btn'>
  </form>

  <!-- ìŠ¤í¬ë¦½íŠ¸ -->
  <script>
    // ìš´ì˜ì‹œê°„ í† ê¸€
    function toggleOperatingHours() {
      const hours = document.getElementById('operatingHours');
      if (hours) {
        hours.style.display = hours.style.display === 'none' ? 'block' : 'none';
      }
    }
    
    // í¼ ì œì¶œ ë°©ì§€ (ê°œì¸ì •ë³´ ë™ì˜ ì „)
    document.getElementById('nofee-purchase-form').addEventListener('submit', function(e) {
      const consent = document.getElementById('privacy_consent').value;
      if (consent !== 'ë™ì˜í•¨') {
        e.preventDefault();
        console.log('ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ ë™ì˜ê°€ í•„ìš”í•©ë‹ˆë‹¤.');
        return false;
      }
    });
    
    // ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ
    function loadNofeeScript() {
      const candidates = [
        'https://cdn.jsdelivr.net/gh/Jacob-PO/nofee_chat@main/main.js',
        'https://jacob-po.github.io/nofee_chat/main.js'
      ];
      
      Promise.any(candidates.map(src => 
        new Promise((resolve, reject) => {
          const script = document.createElement('script');
          script.src = src + '?v=' + Date.now();
          script.onload = () => window.NofeeAI?.init ? resolve(src) : reject();
          script.onerror = reject;
          document.head.appendChild(script);
        })
      ))
      .then(() => {
        // ë²„íŠ¼ ì´ë²¤íŠ¸ ì„¤ì •
        document.getElementById('homeBtn').onclick = () => window.NofeeAI?.resetChat();
        document.getElementById('phoneBtn').onclick = () => window.NofeeAI?.showPhoneList();
        document.getElementById('deliveryBtn').onclick = () => window.NofeeAI?.showDeliveryInfo();
        
        // ì´ˆê¸°í™”
        window.NofeeAI.init();
      })
      .catch(() => {
        document.getElementById('nofeeLoading').innerHTML = 
          'ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.<br>' +
          '<button onclick="location.reload()" style="margin-top:10px;padding:8px 16px;background:#4e5bff;color:white;border:none;border-radius:20px;cursor:pointer">ìƒˆë¡œê³ ì¹¨</button>';
      });
    }
    
    // ì¦‰ì‹œ ì‹¤í–‰
    loadNofeeScript();
  </script>
</div>
